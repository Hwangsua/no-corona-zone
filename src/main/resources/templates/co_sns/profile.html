<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/common_layout}" th:with="activeTab='profile', title='cosns'">

<head>
  <meta charset="UTF-8">
  <meta name="_csrf" th:content="${_csrf.token}"/>
  <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
  <link th:href="@{/css/co_sns/profile.css}" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/jdenticon@3.0.1" async></script>
  <script th:inline="javascript">
    $(document).ready(function () {

      var token = $("meta[name='_csrf']").attr("content");
      var header = $("meta[name='_csrf_header']").attr("content");

      $('#follow-btn').click(function () {

        /*<![CDATA[*/
        //var pageNickname = /*[[${profileMember.nickname}]]*/;
        /*]]>*/

        $.ajax({
          url: '/follow',
          type: 'POST',
          data: {'pageNickname': pageNickname},
          beforeSend: function (xhr){
            xhr.setRequestHeader(header, token);
          }
        });

      });

      $('#unfollow-btn').click(function () {

        /*<![CDATA[*/
        //var pageNickname = /*[[${profileMember.nickname}]]*/;
        /*]]>*/

        $.ajax({
          url: '/unfollow',
          type: 'POST',
          data: {'pageNickname': pageNickname},
          beforeSend: function (xhr){
            xhr.setRequestHeader(header, token);
          }

        });

      });

    });
  </script>
</head>
<body>
<div layout:fragment="content">
  <div class="container">
    <div class="myhistory">
      <div class="myhistory-header">
        <div class="myhistory-img">
          <svg data-jdenticon-value="user" th:data-jdenticon-value="${profileMember.nickname}"
               width="60" height="60" class="rounded border bg-light"></svg>
        </div>
        <div class="myhistory-info">
          <div class="info-list">
            <div class="imgs">
              <span th:text="${profileMember.nickname}"></span>
            </div>
            <div class="imgs">
              백신인증표시
            </div>
          </div>
          <div class="info-list">자기소개</div>
          <span class="introduce" th:text="${profileMember.introduce}"></span>
          <div class="info-list">
            <span class="info-name">사용자 프로필 메세지</span>
            <div class="detail"></div>
          </div>
          <div class="info-list">
            <!--            <span class="info-name">팔로잉</span>-->
            <!--            <div class="detail follows" th:text="${followInfoForm.followingNumber}"></div>-->
            <!--            <span class="info-name">팔로워</span>-->
            <!--            <div class="detail" th:text="${followInfoForm.followerNumber}"></div>-->
          </div>
          <button type="button"  class="btn-style" id="follow-btn">팔로우</button>
          <button type="button"  class="btn-style" id="unfollow-btn">팔로우취소</button>
        </div>
        <div>
          <!--          <div class="myhistory-btn" th:if="${currentMember.no == profileMember.no}">-->
          <!--            <button type="submit" class="btn-style" onclick="location.href='/settings'">정보수정</button>-->
          <!--          </div>-->
          <!--          <div th:if="${currentMember.no != profileMember.no}">-->
          <!--            <div  th:if="${!followInfoForm.followStatus}">-->
          <!--              <button type="button"  class="btn-style" id="follow-btn">팔로우</button>-->
          <!--            </div>-->
          <!--            <div  th:if="${followInfoForm.followStatus}">-->
          <!--              <button type="button"  class="btn-style" id="unfollow-btn">팔로우취소</button>-->
          <!--            </div>-->
          <!--          </div>-->

        </div>


      </div>
      <div class="hr"></div>
      <!--            TODO 타임리프 for문으로 돌리기 -->
      <div class="myhistory-list">
        <div class="mention-each" th:each="mention : ${memberMentionList}">
          <div class="mention-left">
            <div class="profile-img">
              <svg data-jdenticon-value="user" th:data-jdenticon-value="${mention.member.nickname}"
                   width="60" height="60" class="rounded border bg-light"></svg>
            </div>
          </div>
          <div class="mention-right">
            <div class="myhistory-info">
              <div class="nickname">
                <a th:href="@{'/profile/' + ${mention.member.nickname}}">
                  <span th:text="${mention.member.nickname}"></span>
                </a>
              </div>
              <div class="vaccine">
                <img src="img/vaccine.png" alt="" class="vaccine">
              </div>
              <div class="location">
                <span th:text="${mention.location}"></span>
              </div>
              <div class="dot">·</div>
              <div class="myhistory-time">
                                <span class="viewTime"
                                      th:text="${#temporals.format(mention.regdate,'yyyy.MM.dd HH:mm')}"></span>
              </div>
            </div>
            <div class="myhistory-content">
              <a th:href="@{'/mention_detail/' + ${mention.no}}">
                <span th:text="${mention.content}"></span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="sidebar">
<!--      <div class="search">-->
<!--        <form method="get" name="search-mention" th:action="@{search}">-->
<!--          <input type="text" class="search-mention" name="keyword" placeholder="멘션 검색하기">-->
<!--        </form>-->
<!--      </div>-->
      <div class="following">
        <div class="following-box">
          <div class="following-head">
            팔로워
          </div>
          <div class="following-list 1">1</div>
          <div class="following-list 2">2</div>
          <div class="following-list 3">3</div>
          <div class="following-list 4">4</div>
          <div class="following-list 5">5</div>
        </div>
        <div class="following-box">
          <div class="following-head">
            팔로우
          </div>
          <div class="following-list 1">1</div>
          <div class="following-list 2">2</div>
          <div class="following-list 3">3</div>
          <div class="following-list 4">4</div>
          <div class="following-list 5">5</div>
        </div>
      </div>
    </div>
  </div>
</div>
</body>